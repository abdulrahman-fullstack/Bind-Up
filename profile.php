<?php require 'classes/DB.php';require 'classes/Login.php';$editprofile = false;if(isset($_GET['id'])){	if(@$user = DB::query("SELECT * FROM users WHERE id=:id",array(':id'=>$_GET['id']))[0]){		if(Login::isLoggedIn()['id'] == $user['id']){			loggedin_user_profile();		} else{			$logged_user = Login::isLoggedIn();			if(!DB::query("SELECT * FROM followers 				WHERE user_id=:user_id AND follower_id=:follower_id",				array(':user_id'=>$user['id'],':follower_id'=>$logged_user['id']))){				$follow = "Follow";			}			else {								$follow = "Unfollow";			}		}	}else{		error_msg();	}}else if(!isset($_GET['id'])){	if(Login::isLoggedIn()){		loggedin_user_profile();	} else{		error_msg();	}}function loggedin_user_profile(){	global $user;	global $logged_user;	global $editprofile;	$user = Login::isLoggedIn();	$logged_user = Login::isLoggedIn();	$editprofile = true;}function error_msg(){	include 'error.php';	die();}$logged_user = Login::isLoggedIn();$followers = DB::query('SELECT * FROM followers WHERE user_id=:user_id',array(':user_id'=>$user['id']));$followings = DB::query('SELECT * FROM followers WHERE follower_id=:user_id',array(':user_id'=>$user['id']));?><!DOCTYPE html><html lang="en"><head>	<meta charset="UTF-8">	<title><?php echo $user['fname']." &nbsp;".$user['lname']; ?></title>	<link rel="stylesheet" href="css/profile.css">	<link rel="stylesheet" href="css/helvatica.css">	<link rel="stylesheet" href="fonts/montez.css">	<link rel="stylesheet" href="css/font-awesome.css"></head><body><div class="wrap">	<div class="header">		<header><a href="/">BindUp</a></header>		<ul class="nav">			<li class="menu" > Menu				<span class="menu-down">&#9660;</span>			</li>					</ul>		<div class="sub-menu" >			<ul class="hanging-sub-menu">				<li><a href="/" class="menu-it">Home</a></li>				<li><a href="logout.php" class="menu-it">Logout</a></li>			</ul>		</div>	</div>	<div class="profile">		<div class="about clearfix">			<div class="pro-img">				<img src="./images/<?php echo $user['img'] ?>" alt="Profile Picture">			</div>			<div class="pro-details">				<div class="info">Gender - <?php echo $user['gender'] ?></div>				<div class="info">Age - <?php echo date('Y-m-d')-$user['dob']; ?></div>				<div class="info">Followers - <?php echo count($followers); ?></div>				<div class="info">Followings - <?php echo count($followings); ?></div>				<?php if($editprofile): ?>				<div class="edit-profile"><a href="editprofile.php">Edit Profile &nbsp;&nbsp;<i class="fa fa-edit" ></i></a></div>			<?php endif; ?>			</div>		</div>		<div class="abt-usr">			<div class="ufn clearfix">				<div class="ufn-bar">				<?php				echo $user['fname']." ".$user['lname']; 				if($logged_user['id'] != $user['id']):					echo '<input type="button" class="flow '.$follow.'" data-uid="'.$user['id'].'" value="'.$follow.'" >';				endif;			?>				</div>			</div>		</div>		<div class="posts-blk">			<div class="posts">				<?php 				if($all_posts = DB::query("SELECT * FROM posts WHERE user_id=:user_id ORDER BY id DESC ",array(':user_id'=>$user['id']))){					foreach($all_posts as $post){						$date = explode(' ' , $post['posted_at']);						$time = explode(':' , $date[1]);						$like = DB::query("SELECT * fROM post_likes WHERE post_id=:post_id AND liker_id=:liker_id",array(':post_id'=>$post['id'],':liker_id'=>$logged_user['id'])) ? 'Liked' : 'Like' ;						$like_class = DB::query("SELECT * fROM post_likes WHERE post_id=:post_id AND liker_id=:liker_id",array(':post_id'=>$post['id'],':liker_id'=>$logged_user['id'])) ? 'lkd' : 'lk' ;												echo "						<div class='post clearfix'>							<div class='user'>								<h3><a href='profile.php?id=".$post['user_id']."' >".$user['fname']." ".$user['lname']."</a></h3>								<div class='time'>posted at ".$time[0].":".$time[1]."&nbsp;&nbsp; on  ".$date[0]."</div>							</div>							<div class='cont'><pre>".htmlspecialchars($post['post_body'])."</pre></div>							<div class='ops'>								<input type='button' data-pid='".$post['id']."' value='$like' class='like-btn $like_class'>								<span class='pl'>&nbsp;&nbsp; 									<span class='lc'>".$post['likes']."</span> likes								</span>							</div>						</div>						";					}									} else{					echo '<div class="post none clearfix">								NO POSTS YET								</div>';				}				?>			</div>		</div>	</div></div></body><script src="js/jquery-3.2.1.js"></script><script>	$('.flow').on('click',function(){	var self = $(this),		action = self.val()=='Follow' ? 'follow' : 'unfollow' ;	$.ajax({		url:'users/actions.php',		method:'post',		data:{follow:action,user_id:self.data('uid'),follower_id:<?php echo $logged_user['id'] ?>},		success:function(result){			self.val(result).css('opacity' , 1);			self.hasClass('Unfollow') ? self.removeClass('Unfollow').addClass('Follow') : self.removeClass('Follow').addClass('Unfollow') ;		}	});	self.css('opacity' , 0.2);});( function () {		var like = $('input.like-btn'), action,		likes_count = like.siblings('.pl');	like.on('click', function(){		action = $(this).val()=='Like' ? 'true' : 'false' ;		var self = $(this);		$.ajax({			url:'users/actions.php',			method:'post',			data:{like:action,post_id:self.data('pid'),liker_id:<?php echo $logged_user['id'] ?>},			dataType:'json',			success:function(result){				self.val(result.txt).css('opacity' , 1);				result.class == 'lkd' ? self.removeClass('lk').addClass(result.class) : self.removeClass('lkd').addClass(result.class);				self.siblings('.pl').find('.lc').text(result.likes);			}		});		self.css('opacity', 0.2);	});})();( function () {	var vis = true;	$('li.menu').on('click' , function(e){		var arrow = $('div.header > ul.nav > li.menu > span.menu-down'),			hng_men = $('div.header > div.sub-menu');			$(this).toggleClass('active');			arrow_action(arrow);			hanging_sub_menu_toggle(hng_men);	});	var zofmenu = $('div.header > div.sub-menu , div.header > ul.nav > li.menu ').css('z-index');	$(window).on('mouseup',function(e){		var tar = $(e.target),			menu_div = $('div.header > div.sub-menu');		if( ( tar.css('z-index') == 'auto' || tar.css('z-index') < zofmenu ) && !(tar.hasClass('menu-it')) ){			var hng_men = $('div.header > div.sub-menu');			if(hng_men.css('display') === 'block'){				var arrow = $('div.header > ul.nav > li.menu > span.menu-down');				hng_men.slideUp(150);				arrow_action(arrow);				$('li.menu').toggleClass('active');			}		}	});	function hanging_sub_menu_toggle(hng_men){		hng_men.slideToggle(150);	}	function  arrow_action(arrow){		if(!vis){			arrow.addClass('arrow-down').removeClass('arrow-up');			vis = true;		}		else{			arrow.addClass('arrow-up').removeClass('arrow-down');			vis = false;		}	}})();(function(){	var sticky=$('div.abt-usr');	$(window).scroll(function(){		if($(this).scrollTop() >= 20){			sticky.css({position:'fixed',top:40+'px'});		}else{			sticky.css({position:'relative',top:0});					}	});})();</script></html>